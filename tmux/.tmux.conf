# ===========================
# Shell
# ===========================
set-option -g default-shell /usr/bin/zsh
set-option -g default-command /usr/bin/zsh

# ===========================
# General Options
# ===========================
set-option -g mouse on
set-option -g renumber-windows on
set-option -g history-limit 50000
set-option -ga terminal-overrides ',xterm-256color:Tc'
set-option -g base-index 1
set-option -g renumber-windows on
set-option -g pane-base-index 1

# ===========================
# Key Mode Settings
# ===========================
set-option -g status-keys vi
set-window-option -g mode-keys vi

# ===========================
# Session key bindings
# ===========================
bind-key Tab switch-client -n
bind-key BTab switch-client -p
bind-key N new-session
bind-key K confirm-before -p "Kill session #S? (y/n)" kill-session

# ===========================
# Appearance: Status Bar
# ===========================
set-option -g status on
set-option -g status-bg "#282c34"
set-option -g status-fg "#abb2bf"
set-option -g status-interval 1

set-option -g status-left "#[fg=#61afef,bg=#282c34,bold] #S #[default]"
set-option -g status-right "#[fg=#5c6370,bg=#282c34] [#H] #[fg=#61afef]%a %b %-d %H:%M:%S#[default]"

# ===========================
# Window Titles
# ===========================
set-window-option -g window-status-format "#[fg=#5c6370,bg=#61afef] #I:#W #[default]"
set-window-option -g window-status-current-format "#[fg=#282c34,bg=#98c379,bold] #I:#W #[default]"
set-window-option -g window-status-last-style "fg=#5c6370,bg=#e5c07b"
set-option -g message-style "bg=#282c34,fg=#abb2bf"
set-option -g mode-style "bg=#c678dd,fg=#282c34"

# ===========================
# Pane Borders
# ===========================
set-option -g pane-border-style "fg=#5c6370"
set-option -g pane-active-border-style "fg=#61afef"

# ===========================
# Pane Management
# ===========================
unbind-key x
unbind-key r
bind-key x confirm-before -p "Kill current pane? (y/n)" "kill-pane"
bind-key r confirm-before -p "Respawn current pane? (y/n)" "respawn-pane -k"

# Equalize all panes
bind = select-layout tiled
bind - select-layout even-horizontal
bind _ select-layout even-vertical
bind | select-layout main-vertical

# ===========================
# Vim-style Pane Navigation
# ===========================
bind h select-pane -L
bind j select-pane -D
bind k select-pane -U
bind l select-pane -R

# ===========================
# Mouse and Scroll Behavior
# ===========================
bind-key -n WheelUpPane if-shell -F -t = "#{mouse_any_flag}" "send-keys -M" \
  "if -Ft= '#{pane_in_mode}' 'send-keys -M' 'select-pane -t=; copy-mode -e; send-keys -M'"
bind-key -n WheelDownPane select-pane -t= \; send-keys -M
bind-key -n C-WheelUpPane select-pane -t= \; copy-mode -e \; send-keys -M
bind-key -T copy-mode-vi C-WheelUpPane send-keys -X halfpage-up
bind-key -T copy-mode-vi C-WheelDownPane send-keys -X halfpage-down

# ===========================
# Window and Pane Management
# ===========================
unbind-key %
bind-key % run-shell "tmux split-window -h -c \"$(tmux display -p -F '#{pane_current_path}')\""

unbind-key '"'
bind-key '"' run-shell "tmux split-window -v -c \"$(tmux display -p -F '#{pane_current_path}')\""

unbind -T root C-a
unbind -T copy-mode C-a
unbind -T prefix C-a
unbind C-a
bind-key a set-window-option synchronize-panes

# ===========================
# Pop-Up Window
# ===========================
bind-key t display-popup -E -w 60% -h 80% -d "#{pane_current_path}" "tmux new-session -A -s âš¡"

# ===========================
# Copy and Clipboard Integration
# ===========================
unbind-key -T copy-mode-vi Enter
bind-key -T copy-mode-vi Enter send-keys -X copy-pipe-and-cancel "xsel --clipboard --input"
bind-key -T copy-mode-vi MouseDragEnd1Pane send-keys -X copy-pipe-and-cancel "xsel --clipboard --input"
# bind-key -T copy-mode-vi Enter send-keys -X copy-pipe-and-cancel "xclip -selection clipboard -loops 1"
# bind-key -T copy-mode-vi MouseDragEnd1Pane send-keys -X copy-pipe-and-cancel "xclip -selection clipboard -loops 1"
# bind-key -T copy-mode-vi Enter send-keys -X copy-pipe-and-cancel "xclip -selection c"
# bind-key -T copy-mode-vi MouseDragEnd1Pane send-keys -X copy-pipe-and-cancel "xclip -in -selection clipboard"

# ===========================
# Plugins
# ===========================
set-option -g @plugin 'tmux-plugins/tmux-yank'
# set-option -g @plugin 'tmux-plugins/tmux-resurrect'

# run-shell '~/.tmux/plugins/tpm/tpm'
# run-shell '~/.tmux/plugins/tmux-resurrect/resurrect.tmux'
